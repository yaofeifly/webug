<?php
//禁用错误报告
error_reporting(0);
header("Content-Type: text/html;charset=utf-8");
echo "<title>帮管理员找回mysql帐号密码</title>";
if(isset($_POST["pic"]))
{ 
#echo $_POST['pic']."</br>";
$pic_name=$_POST['pic'];
//用以解决中文不能显示出来的问题 
#$pic_name=iconv("utf-8","gb2312",$pic_name); 

$file_sub_path=$_SERVER['DOCUMENT_ROOT']."/topsec/any_file_download_V1.0/data/"; 
$file_path=$file_sub_path.$pic_name; 

#echo $file_path."</br>";



$hfile = fopen($file_path, "rb") or die("Can not find file: $file_path\n");
Header("Content-type: application/octet-stream");
         Header("Content-Transfer-Encoding: binary");
         Header("Accept-Ranges: bytes");
         Header("Content-Length: ".filesize($file_path));
         Header("Content-Disposition: attachment; filename=\"$pic_name\"");
         while (!feof($hfile)) {
            echo fread($hfile, 32768);
         }
         fclose($hfile);
/**
**/
}
?>
<center>图片商城下载测试</center>
<hr/>
<br/>
<table border="1px">
<tr>
<td>序号</td>
<td>文件预览</td>

</tr>
<tr>
<td>1</td>
<td><img src="data/dog_cat.jpg" width="300px" height="150px"/></td>

</tr>
<tr>
<td>2</td>
<td><img src="data/IT_worker.jpg" width="300px" height="150px"/></td>

</tr>
<tr>
<td colspan="2">
请对应上面的序号下载的图片
</td>
</tr>
<tr>
<td colspan="2">
<form action="" method="post">
<select name="pic">  
  <option value ="dog_cat.jpg">1</option>  
  <option value ="IT_worker.jpg">2</option>   
</select>  
<input type="submit" name="submit" value="下载"/>
</form>
</td>
</tr>
</table>